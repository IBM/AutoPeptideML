outputdir: butina_eval

databases:
  neg_database:
    path: peptipedia2.csv
    feat_fields: sequence
    verbose: true
    columns_to_exclude: 
      - Blood brain barrier penetrating

  dataset:
    path: ./downstream_data/BBP.csv
    feat_fields: sequence
    label_field: "Y"
    verbose: false


pipeline:
  name: main_pipe
  aggregate: True
  elements:
    - pipe1:
        name: pipe1
        aggregate: False
        elements:
          - filter-smiles:
    - pipe2:
        name: pipe2
        aggregate: False
        elements:
          - filter-smiles:
              keep_smiles: False
          - canonical-cleaner:
              substitution: G 
          - sequence-to-smiles:

representation:
  verbose: true
  elements:
    - chemberta-2:
        engine: lm
        model: chemberta-2
        device: mps
        batch_size: 64
        average_pooling: True
    - ecfp:
        engine: fp
        fp: ecfp
        nbits: 2048
        radius: 8

test:
  partitions: all
  threshold_step: 0.1
  min_threshold: 0
  verbose: 1
  algorithm: butina
  filter: 0.185
  sim_arguments:
    data_type: molecule
    min_threshold: 0
    sim_function: tanimoto
    field_name: sequence
    fingerprint: ecfp
    radius: 6
    bits: 2048
    verbose: 1

val:
  type: kfold
  k: 10
  random_state: 1

train:
  optim_strategy:
    trainer: optuna
    n_steps: 20
    patience: 20
    direction: maximize
    task: class
    metric: mcc
    n_jobs: 10
    partition: random

  hspace:
    models:
      type: fixed
      elements:
        rf:
          - n_estimators:
              type: int
              min: 10
              max: 1000
              log: true
        svm:
          - C:
              type: float
              min: 0.000001
              max: 0.1
              log: true
          - probability:
              type: fixed
              value: true
    
    representations:
        - chemberta-2
        - ecfp
